-- Sequence for primary key
CREATE SEQUENCE CUSTOMER_ID_SEQ
    START WITH 1
    INCREMENT BY 1 NOCACHE
    NOCYCLE;

-- CUSTOMER table
CREATE TABLE CUSTOMER
(
    ID         NUMBER(19) PRIMARY KEY,
    CUST_ID    NUMBER(19) UNIQUE NOT NULL,
    NAME       VARCHAR2(200) NOT NULL,
    PHONE      VARCHAR2(30)  NOT NULL,
    EMAIL      VARCHAR2(150) NOT NULL,
    GENDER     VARCHAR2(20)  NOT NULL,
    DOB        DATE          NOT NULL, -- use DATE instead of VARCHAR2
    CREATED_BY NUMBER(19)    NOT NULL,
    UPDATED_BY NUMBER(19),
    CREATED_AT TIMESTAMP DEFAULT SYSTIMESTAMP NOT NULL,
    UPDATED_AT TIMESTAMP
);

-- Foreign keys to USERS table
ALTER TABLE CUSTOMER
    ADD CONSTRAINT FK_CUSTOMER_CREATEDBY
        FOREIGN KEY (CREATED_BY) REFERENCES USERS (ID);

ALTER TABLE CUSTOMER
    ADD CONSTRAINT FK_CUSTOMER_UPDATEDBY
        FOREIGN KEY (UPDATED_BY) REFERENCES USERS (ID);

-- Helpful indexes for faster search
CREATE INDEX IDX_CUSTOMER_NAME ON CUSTOMER (NAME);
CREATE INDEX IDX_CUSTOMER_PHONE ON CUSTOMER (PHONE);
CREATE INDEX IDX_CUSTOMER_EMAIL ON CUSTOMER (EMAIL);
CREATE INDEX IDX_CUSTOMER_CUSTID ON CUSTOMER (CUST_ID);
